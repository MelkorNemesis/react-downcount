{"version":3,"file":"index.es.js","sources":["../src/consts.js","../src/utils.js","../src/renderer.js","../node_modules/style-inject/dist/style-inject.es.js","../src/index.js"],"sourcesContent":["export const ONE_SECOND_IN_MILLISECONDS = 1000\nexport const ONE_MINUTE_IN_MILLISECONDS = 60 * ONE_SECOND_IN_MILLISECONDS\nexport const ONE_HOUR_IN_MILLISECONDS = 60 * ONE_MINUTE_IN_MILLISECONDS\nexport const ONE_DAY_IN_MILLISECONDS = 24 * ONE_HOUR_IN_MILLISECONDS\n","export function doubleDigit(val) {\n  return String(val).padStart(2, '0')\n}\n","/* eslint-disable react/prop-types */\n\nimport React, { Fragment } from 'react'\nimport { doubleDigit } from './utils'\n\nconst renderer = ({ days, hrs, mins, secs }) =>\n  <Fragment>{days} days {doubleDigit(hrs)}:{doubleDigit(mins)}:{doubleDigit(secs)}</Fragment>\n\nexport default renderer\n","function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","import React, { PureComponent } from 'react'\nimport PropTypes from 'prop-types'\n\nimport {\n  ONE_MINUTE_IN_MILLISECONDS,\n  ONE_HOUR_IN_MILLISECONDS,\n  ONE_DAY_IN_MILLISECONDS\n} from './consts'\nimport defaultRenderer from './renderer'\n\nimport styles from './styles.css'\n\nconst DEFAULT_STATE = {\n  days: 0,\n  hrs: 0,\n  mins: 0,\n  secs: 0,\n  timestamp: null,\n  isCompleted: false\n}\n\nexport default class Countdown extends PureComponent {\n  static propTypes = {\n    endDate: PropTypes.oneOfType([\n      PropTypes.number,\n      PropTypes.instanceOf(Date)\n    ]).isRequired,\n    onCompleted: PropTypes.func,\n    className: PropTypes.string,\n    children: PropTypes.func,\n    useDays: PropTypes.bool,\n    useHours: PropTypes.bool,\n    useMinutes: PropTypes.bool\n  }\n\n  static defaultProps = {\n    children: defaultRenderer,\n    useDays: true,\n    useHours: true,\n    useMinutes: true\n  }\n\n  static normalize = (now) => {\n    if (now instanceof Date) {\n      return +now\n    }\n    return now\n  }\n\n  intervalId = null\n  state = { ...DEFAULT_STATE }\n\n  componentWillMount() {\n    this.init()\n  }\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.endDate !== this.props.endDate) {\n      this.stop()\n      this.init()\n    }\n  }\n\n  componentWillUnmount() {\n    this.stop()\n  }\n\n  init = () => {\n    /* istanbul ignore next */\n    if (this.props.endDate) {\n      const now = Date.now()\n      this.setState({\n        timestamp: this.constructor.normalize(this.props.endDate),\n        isCompleted: false\n      }, () => {\n        if (now < this.state.timestamp) {\n          this.update(now)\n          this.start()\n        } else {\n          this.stop({ isCompleted: true })\n          this.complete()\n        }\n      })\n    }\n  }\n\n  start = () => {\n    this.intervalId = setInterval(this.tick, 1000)\n  }\n\n  tick = () => {\n    const now = Date.now()\n    if (now >= this.state.timestamp) {\n      this.stop({ isCompleted: true })\n      this.complete()\n    } else {\n      this.update(now)\n    }\n  }\n\n  update = (now) => {\n    // how much time is left\n    let diff = Math.round((this.state.timestamp - now))\n    // round up to the whole seconds\n    diff = Math.round(diff / 1000) * 1000\n\n    const timeLeft = {\n      days: 0,\n      hrs: 0,\n      mins: 0,\n      secs: 0\n    }\n\n    const { useDays, useHours, useMinutes } = this.props\n\n    if (useDays && diff >= ONE_DAY_IN_MILLISECONDS) {\n      timeLeft.days = Math.floor(diff / ONE_DAY_IN_MILLISECONDS)\n      diff -= timeLeft.days * ONE_DAY_IN_MILLISECONDS\n    }\n    if (useHours && diff >= ONE_HOUR_IN_MILLISECONDS) {\n      timeLeft.hrs = Math.floor(diff / ONE_HOUR_IN_MILLISECONDS)\n      diff -= timeLeft.hrs * ONE_HOUR_IN_MILLISECONDS\n    }\n    if (useMinutes && diff >= ONE_MINUTE_IN_MILLISECONDS) {\n      timeLeft.mins = Math.floor(diff / ONE_MINUTE_IN_MILLISECONDS)\n      diff -= timeLeft.mins * ONE_MINUTE_IN_MILLISECONDS\n    }\n    timeLeft.secs = Math.round(diff / 1000)\n\n    this.setState(timeLeft)\n  }\n\n  stop = ({ isCompleted = false } = {}) => {\n    this.setState({ ...DEFAULT_STATE, isCompleted })\n    if (this.intervalId) {\n      clearInterval(this.intervalId)\n      this.intervalId = null\n    }\n  }\n\n  complete = () => {\n    const { onCompleted } = this.props\n    onCompleted && onCompleted()\n  }\n\n  render() {\n    const {\n      endDate,\n      onCompleted,\n      useDays,\n      useHours,\n      useMinutes,\n      className,\n      children,\n      ...restProps\n    } = this.props\n\n    const { days, hrs, mins, secs, isCompleted } = this.state\n\n    return (\n      <div className={className || styles.countdown} {...restProps}>\n        {children({ days, hrs, mins, secs, isCompleted })}\n      </div>\n    )\n  }\n}\n\nexport { doubleDigit } from './utils'\n"],"names":["ONE_SECOND_IN_MILLISECONDS","ONE_MINUTE_IN_MILLISECONDS","ONE_HOUR_IN_MILLISECONDS","ONE_DAY_IN_MILLISECONDS","doubleDigit","val","String","padStart","renderer","days","hrs","mins","secs","DEFAULT_STATE","Countdown","intervalId","state","init","props","endDate","now","Date","setState","constructor","normalize","timestamp","update","start","stop","isCompleted","complete","setInterval","tick","diff","Math","round","timeLeft","useDays","useHours","useMinutes","floor","onCompleted","prevProps","className","children","restProps","styles","countdown","PureComponent","propTypes","PropTypes","oneOfType","number","instanceOf","isRequired","func","string","bool","defaultProps","defaultRenderer"],"mappings":"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"}